% The functions used

% My first function, kept for nostalic reasons
\newcommand{\sayhello}{hello and howdy!}

% Making a note
\newcommand\note[1]{\textcolor{green}{\todo{#1}}}

% From https://tex.stackexchange.com/a/98034
\newcommand*\mean[1]{\overline{#1}}

% From https://tex.stackexchange.com/a/101138
% \newcommand\reallywidetilde[1]{\ThisStyle{%
%   \setbox0=\hbox{$\SavedStyle#1$}%
%   \stackengine{-.1\LMpt}{$\SavedStyle#1$}{%
%     \stretchto{\scaleto{\SavedStyle\mkern.2mu\AC}{.5150\wd0}}{.6\ht0}%
%   }{O}{c}{F}{T}{S}%
% }}

% Adapted from 'mean', use 'reallywidetilde'
% \newcommand*\median[1]{\reallywidetilde{#1}}

\newcommand*\median[1]{\widetilde{#1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Create the TikZ picture for fig:experiment
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\CreateTikzFigureExperiment} {

  \begin{tikzpicture} 

    % Incipient species tree
    \begin{scope}[shift={(0,0)}] 

      \node[font = \bf] at (0, 0) {A)};
      \draw (-1,1) rectangle (10,-7);

      % Drawing of the phylogeny
      \begin{scope}[shift={(0,-3)}] 
        \draw (0, 0) -- (2,  0); % stem 
        \draw (2, 0) -- (8,  3) node[anchor=west] {$A_1$};
        \draw[dotted] (4,  -1) -- (5, -0.5); \draw (5, -0.5) -- (8, 1) node[anchor=west] {$B$};
        \draw[dotted] (6,  -2) -- (7, -1.5); \draw (7, -1.5) -- (8, -1) node[anchor=west] {$C$};
        \draw[dotted] (2,0) -- (8, -3) node[anchor=west] {$A_2$};
      \end{scope} % Drawing of the phylogeny

    \end{scope}


    % Species tree, oldest
    \begin{scope}[shift={(-6,-9)}] 

      \node[font = \bf] at (0.0, 0  ) {B1)};
      \draw (-1,1) rectangle (10,-7);

      % Drawing of the species tree, oldest
      \begin{scope}[shift={(0,-3)}] 
        \draw (0, 0) -- (2,  0); % stem 
        \draw (2, 0) -- (8,  3) node[anchor=west] {$A_1$};
        \draw (4,  -1) -- (8, 1) node[anchor=west] {$B$};
        \draw (2,0) -- (8, -3) node[anchor=west] {$C$};
      \end{scope} % Drawing of the species tree, oldest

    \end{scope}


    % Species tree, youngest
    \begin{scope}[shift={( 6,-9)}] 

      \node[font = \bf] at (0, 0) {B2)};
      \draw (-1,1) rectangle (10,-7);

      % Drawing of the species tree, youngest
      \begin{scope}[shift={(0,-3)}] 
        \draw (0, 0) -- (4,  0); % stem 
        \draw (4, 0) -- (8,  2) node[anchor=west] {$B$};
        \draw (6,-1) -- (8,  0) node[anchor=west] {$C$};
        \draw (4, 0) -- (8, -2) node[anchor=west] {$A_2$};
      \end{scope} % Drawing of the species tree, youngest

    \end{scope}

    % Alignment, oldest
    \begin{scope}[shift={(-6,-18)}] 

      \node[font = \bf] at (0.0, 0  ) {C1)};
      \draw (-1,1) rectangle (10,-4);

      % Drawing of the alignment
      \begin{scope}[shift={(1,-1)}, text width = 4mm, text height = 3mm, align = center, scale = 1.3] 

        \node[draw, fill = red   ] at (0.0, 0  ) {A};
        \node[draw, fill = red   ] at (0.5, 0  ) {A};
        \node[draw, fill = red   ] at (1.0, 0  ) {A};
        \node[draw, fill = red   ] at (1.5, 0  ) {A};
        \node[draw, fill = red   ] at (2.0, 0  ) {A};
        \node[draw, fill = red   ] at (2.5, 0  ) {A};
        \node[draw, fill = red   ] at (3.0, 0  ) {A};
        \node[draw, fill = red   ] at (3.5, 0  ) {A};
        \node[draw, fill = red   ] at (4.0, 0  ) {A};
        \node[draw, fill = red   ] at (4.5, 0  ) {A};
        \node[draw, fill = red   ] at (5.0, 0  ) {A};
        \node[draw, fill = red   ] at (5.5, 0  ) {A};
        \node[                   ] at (6.0, 0  ) {$A_1$};

        \node[draw, fill = red   ] at (0.0, -0.5) {A};
        \node[draw, fill = yellow] at (0.5, -0.5) {C};
        \node[draw, fill = yellow] at (1.0, -0.5) {C};
        \node[draw, fill = yellow] at (1.5, -0.5) {C};
        \node[draw, fill = red   ] at (2.0, -0.5) {A};
        \node[draw, fill = yellow] at (2.5, -0.5) {C};
        \node[draw, fill = yellow] at (3.0, -0.5) {C};
        \node[draw, fill = yellow] at (3.5, -0.5) {C};
        \node[draw, fill = red   ] at (4.0, -0.5) {A};
        \node[draw, fill = yellow] at (4.5, -0.5) {C};
        \node[draw, fill = yellow] at (5.0, -0.5) {C};
        \node[draw, fill = yellow] at (5.5, -0.5) {C};
        \node[                   ] at (6.0, -0.5) {$B$};

        \node[draw, fill = red] at (0.0, -1.0) {A};
        \node[draw, fill = yellow] at (0.5, -1.0) {C};
        \node[draw, fill = yellow] at (1.0, -1.0) {C};
        \node[draw, fill = yellow] at (1.5, -1.0) {C};
        \node[draw, fill = red   ] at (2.0, -1.0) {A};
        \node[draw, fill = yellow] at (2.5, -1.0) {C};
        \node[draw, fill = green ] at (3.0, -1.0) {G};
        \node[draw, fill = blue  ] at (3.5, -1.0) {T};
        \node[draw, fill = red   ] at (4.0, -1.0) {A};
        \node[draw, fill = yellow] at (4.5, -1.0) {C};
        \node[draw, fill = green ] at (5.0, -1.0) {G};
        \node[draw, fill = blue  ] at (5.5, -1.0) {T};
        \node[                   ] at (6.0, -1.0) {$C$};

      \end{scope} % Drawing of the alignment

    \end{scope}

    % Alignment, youngest
    \begin{scope}[shift={(6,-18)}] 

      \node[font = \bf] at (0.0, 0  ) {C2)};
      \draw (-1,1) rectangle (10,-4);

      % Drawing of the alignment
      \begin{scope}[shift={(1,-1)}, text width = 4mm, text height = 3mm, align = center, scale = 1.3] 

        \node[draw, fill = red   ] at (0.0, 0  ) {A};
        \node[draw, fill = red   ] at (0.5, 0  ) {A};
        \node[draw, fill = red   ] at (1.0, 0  ) {A};
        \node[draw, fill = red   ] at (1.5, 0  ) {A};
        \node[draw, fill = red   ] at (2.0, 0  ) {A};
        \node[draw, fill = red   ] at (2.5, 0  ) {A};
        \node[draw, fill = red   ] at (3.0, 0  ) {A};
        \node[draw, fill = red   ] at (3.5, 0  ) {A};
        \node[draw, fill = red   ] at (4.0, 0  ) {A};
        \node[draw, fill = red   ] at (4.5, 0  ) {A};
        \node[draw, fill = red   ] at (5.0, 0  ) {A};
        \node[draw, fill = red   ] at (5.5, 0  ) {A};
        \node[                   ] at (6.0, 0  ) {$B$};

        \node[draw, fill = red   ] at (0.0, -0.5) {A};
        \node[draw, fill = red   ] at (0.5, -0.5) {A};
        \node[draw, fill = red   ] at (1.0, -0.5) {A};
        \node[draw, fill = red   ] at (1.5, -0.5) {A};
        \node[draw, fill = red   ] at (2.0, -0.5) {A};
        \node[draw, fill = yellow] at (2.5, -0.5) {C};
        \node[draw, fill = yellow] at (3.0, -0.5) {C};
        \node[draw, fill = yellow] at (3.5, -0.5) {C};
        \node[draw, fill = red   ] at (4.0, -0.5) {A};
        \node[draw, fill = yellow] at (4.5, -0.5) {C};
        \node[draw, fill = yellow] at (5.0, -0.5) {C};
        \node[draw, fill = yellow] at (5.5, -0.5) {C};
        \node[                   ] at (6.0, -0.5) {$C$};

        \node[draw, fill = red   ] at (0.0, -1.0) {A};
        \node[draw, fill = red   ] at (0.5, -1.0) {A};
        \node[draw, fill = red   ] at (1.0, -1.0) {A};
        \node[draw, fill = red   ] at (1.5, -1.0) {A};
        \node[draw, fill = red   ] at (2.0, -1.0) {A};
        \node[draw, fill = yellow] at (2.5, -1.0) {C};
        \node[draw, fill = yellow] at (3.0, -1.0) {C};
        \node[draw, fill = yellow] at (3.5, -1.0) {C};
        \node[draw, fill = red   ] at (4.0, -1.0) {A};
        \node[draw, fill = yellow] at (4.5, -1.0) {C};
        \node[draw, fill = green ] at (5.0, -1.0) {G};
        \node[draw, fill = blue  ] at (5.5, -1.0) {T};
        \node[                   ] at (6.0, -1.0) {$A_2$};

      \end{scope} % Drawing of the alignment

    \end{scope}



    % Estimated species tree, oldest
    \begin{scope}[shift={(-6,-24)}] 

      \node[font = \bf] at (0, 0) {D1)};
      \draw (-1,1) rectangle (10,-7);

      \begin{scope}[shift={(0,-3)}] 
        \draw (0, 0) -- (3,  0);
        \draw (3, 0) -- (8, 3) node[anchor=west] {$A_1$};
        \draw (4,-0.6) -- (8, 1.6) node[anchor=west] {$B$};
        \draw (3, 0) -- (8,-3) node[anchor=west] {$C$};
      \end{scope}

    \end{scope}


    % Estimated species tree, youngest
    \begin{scope}[shift={(6,-24)}] 

      \node[font = \bf] at (0, 0) {D2)};
      \draw (-1,1) rectangle (10,-7);

      \begin{scope}[shift={(0,-3)}] 
        \draw (0, 0) -- (3,  0);
        \draw (3, 0) -- (8,  2) node[anchor=west] {$B$};
        \draw (6,-1.2) -- (8, -0.2) node[anchor=west] {$C$};
        \draw (3, 0) -- (8, -2) node[anchor=west] {$A_2$};
      \end{scope}

    \end{scope}

  \end{tikzpicture}
} % End of create_figure_experiment definition
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Create the TikZ picture of fig:sampling
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\CreateTikzFigureSampling} {

  \begin{tikzpicture}[scale = 0.5] 

    \begin{scope}[shift={(0,0)}] 

      \node[font = \bf] at (0, 0) {A)};
      \draw (-1,1) rectangle (10,-8.5);

      % Drawing of the phylogeny
      \begin{scope}[shift={(0,-3)}] 
        \draw (0, 0) -- (2,  0);
        \draw (2, 0) -- (8,  3) node[anchor=west] {$A_1$};
        \draw[dotted] (2, 0) -- (8, -3) node[anchor=west] {$A_2$};
        \draw[dotted] (4, -1) -- (6, 0);
        \draw (6, 0) -- (8, 1) node[anchor=west] {$B$};
        % time scale
        \draw (0, -4) -- (8,  -4);
        \draw (0, -3.8) -- (0,  -4.2) node[anchor=north] {$t_0$};
        \draw (2, -3.8) -- (2,  -4.2) node[anchor=north] {$t_1$};
        \draw (4, -3.8) -- (4,  -4.2) node[anchor=north] {$t_2$};
        \draw (6, -3.8) -- (6,  -4.2) node[anchor=north] {$t_3$};
        \draw (8, -3.8) -- (8,  -4.2) node[anchor=north] {$t_4$};
      \end{scope} % Drawing of the phylogeny

    \end{scope}
    \begin{scope}[shift={(0, -10)}] 

      \node[font = \bf] at (0, 0) {B)};
      \draw (-1,1) rectangle (10,-8.5);

      % Drawing of the phylogeny
      \begin{scope}[shift={(0,-3)}] 
        \draw (0, 0) -- (2,  0);
        \draw (2, 0) -- (8,  3) node[anchor=west] {$A_1$};
        \draw (2, 0) -- (8, -3) node[anchor=west] {$B$};
        % time scale
        \draw (0, -4) -- (8,  -4);
        \draw (0, -3.8) -- (0,  -4.2) node[anchor=north] {$t_0$};
        \draw (2, -3.8) -- (2,  -4.2) node[anchor=north] {$t_1$};
        \draw (4, -3.8) -- (4,  -4.2) node[anchor=north] {$t_2$};
        \draw (6, -3.8) -- (6,  -4.2) node[anchor=north] {$t_3$};
        \draw (8, -3.8) -- (8,  -4.2) node[anchor=north] {$t_4$};
      \end{scope} % Drawing of the phylogeny

    \end{scope}
    \begin{scope}[shift={(0,-20)}] 

      \node[font = \bf] at (0, 0) {C)};
      \draw (-1,1) rectangle (10,-8.5);

      % Drawing of the phylogeny
      \begin{scope}[shift={(0,-3)}] 
        \draw (0, -1) -- (4, -1) ;
        \draw (4, -1) -- (8, -3) node[anchor=west] {$B$};
        \draw (4, -1) -- (8,  1) node[anchor=west] {$A_2$};
        % time scale
        \draw (0, -4) -- (8,  -4);
        \draw (0, -3.8) -- (0,  -4.2) node[anchor=north] {$t_0$};
        \draw (2, -3.8) -- (2,  -4.2) node[anchor=north] {$t_1$};
        \draw (4, -3.8) -- (4,  -4.2) node[anchor=north] {$t_2$};
        \draw (6, -3.8) -- (6,  -4.2) node[anchor=north] {$t_3$};
        \draw (8, -3.8) -- (8,  -4.2) node[anchor=north] {$t_4$};
      \end{scope} % Drawing of the phylogeny

    \end{scope}
  \end{tikzpicture}

} % End of create_figure_experiment definition
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

